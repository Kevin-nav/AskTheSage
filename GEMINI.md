# GEMINI.md

## Directory Overview

This directory is for a new project. The purpose of the project is not yet clear from the files present.

## Key Files

*   `README.md`: This file should contain a detailed description of the project.
*   `docs/`: This directory can be used to store project documentation.
*   `src/`: This directory can be used to store source code.

## Usage

This directory is intended to be used for a new project. The user should add a `README.md` file to describe the project and create other files and directories as needed.

---

## Codebase File Purposes (Excluding Sir_Johnson_study_bot/)

### Root Directory

*   `.env.example`: Example environment variables for database connection, Telegram bot token, and AWS S3 details.
*   `.gitignore`: Specifies files and directories to be ignored by Git.
*   `Adaptive_Learning_Telegram_Bot.txt`: High-level vision, core features, and logic for the adaptive learning Telegram bot.
*   `alembic.ini`: Configuration file for Alembic database migrations.
*   `analyze_questions.py`: Script to analyze JSON question files, providing metrics like missing fields, LaTeX presence, and difficulty score distribution.
*   `attachment.txt`: Contains a detailed ruleset for gauging MCQ difficulty, outlining base scores and multipliers based on cognitive demand, note reference, distractor complexity, and question structure.
*   `check_db_status.py`: Script to check the status of the database, specifically for a given user's quiz sessions.
*   `clear_incomplete_sessions.py`: Script to mark incomplete quiz sessions for a specific user as completed.
*   `DEBUG_REPORT.md`: A detailed debugging report outlining issues encountered during LaTeX image rendering, including S3 permission errors and LaTeX compilation failures.
*   `Details.txt`: Provides a conceptual overview and architectural details of the Telegram bot, covering UI, smart question selection, on-demand image rendering, and load balancing.
*   `EC2_Architecture.md`: Documents the AWS EC2 architecture for the bot, detailing VPC peering, RDS access, and S3 bucket access across different AWS accounts.
*   `GEMINI.md`: This file, containing project overview and now, codebase documentation.
*   `LaTeX_Rendering_Guide.md`: Guide for setting up and using the offline LaTeX rendering service, including system and Python dependencies, S3 IAM policy, and troubleshooting.
*   `question_tracker.db`: SQLite database file used by the `MCQImageRenderer` to track rendered questions.
*   `README.md`: Main project README, providing an overview, core features, architecture, and setup guide.
*   `requirements.txt`: Lists Python dependencies required for the project.
*   `temp_formatter_test.py`: Script for testing LaTeX formatting fixes in JSON question files.
*   `temp_renderer_test.py`: Script for testing the `MCQRenderer` by rendering sample questions to local files.
*   `test_latex_question_count.py`: Script to count questions with LaTeX content in a JSON file.
*   `test_render.png`: Sample image file generated by the LaTeX renderer for testing purposes.

### `alembic/` Directory

*   `alembic/env.py`: Environment script for Alembic, responsible for configuring the SQLAlchemy engine and loading models for migrations.
*   `alembic/README`: Basic README for the Alembic directory.
*   `alembic/script.py.mako`: Mako template used by Alembic to generate new migration scripts.
*   `alembic/versions/0e839789f4fa_make_course_program_association_columns_.py`: Alembic migration script to make `course_id` and `program_id` columns non-nullable and add a primary key to `course_program_association`.
*   `alembic/versions/0fad22b1cd52_create_initial_database_schema.py`: Alembic migration script to create the initial database schema, including `faculties`, `levels`, `users`, `courses`, `programs`, `course_program_association`, `questions`, and `user_answers` tables.
*   `alembic/versions/4041aa968d62_add_explanation_column_to_questions_.py`: Alembic migration script to add an `explanation` column to the `questions` table.
*   `alembic/versions/45eab53f22cc_add_full_schema_for_adaptive_learning_.py`: Alembic migration script to add the full schema for the adaptive learning system, including `interaction_logs` table and new columns to `questions`, `quiz_session_questions`, `quiz_sessions`, and `user_answers` tables.
*   `alembic/versions/4bd039fb843b_add_has_latex_difficulty_score_and_.py`: Alembic migration script to add `has_latex`, `difficulty_score`, and `explanation_image_url` columns to the `Question` model.
*   `alembic/versions/4ea05a643ed7_add_score_tracking_to_quizsession.py`: Alembic migration script to add `questions_count` and `correct_answers` columns for score tracking to the `quiz_sessions` table.
*   `alembic/versions/636fda186aff_change_telegram_id_to_biginteger.py`: Alembic migration script to change the `telegram_id` column in the `users` table to `BigInteger`.
*   `alembic/versions/92fa3315c14e_change_question_correct_answer_to_.py`: Alembic migration script to change the `correct_answer` column in the `questions` table to `Integer`.
*   `alembic/versions/bac0da5bfa2f_add_image_url_to_question_model.py`: Alembic migration script to add an `image_url` column to the `Question` model.
*   `alembic/versions/bfbb013f636e_add_options_and_correct_answer_to_.py`: Alembic migration script to add `options` (JSON type) and `correct_answer` columns to the `Question` model.
*   `alembic/versions/c4e391ed18e5_add_quiz_session_tables.py`: Alembic migration script to add `quiz_sessions` and `quiz_session_questions` tables.
*   `alembic/versions/d5260d5f095b_merge_branches.py`: Alembic migration script to merge two previous migration branches.

### `formatted_questions/` Directory

*   `formatted_questions/basic_electronics_structured.json`: JSON file containing structured question data for "Basic Electronics", including question text, options, correct answer, explanation, and LaTeX indicators.
*   `formatted_questions/basic_electronics.txt`: Text file containing questions and answers for "Basic Electronics", likely a raw source before JSON formatting.
*   `formatted_questions/basic_redudnant.json`: JSON file containing redundant question data, likely a test or duplicate set of "Basic Electronics" questions.
*   `formatted_questions/basic_electronics_parts/basic_electronics_questions.json`: JSON file containing parts of "Basic Electronics" questions, similar to `basic_electronics_structured.json`.
*   `formatted_questions/basic_french_2/basic_french_questions.json`: JSON file containing structured question data for "Basic French II".
*   `formatted_questions/basic_french_2/french_questions.txt`: Text file containing questions and answers for "Basic French II", likely a raw source before JSON formatting.

### `Questions/` Directory

*   `Questions/Basic_Electornics/*.pdf`: PDF documents containing various answered MCQs, essay questions, and exam papers related to "Basic Electronics". These are likely source materials for questions.
*   `Questions/Basic_french_II/*.pdf`: PDF documents containing various exam papers and quizzes related to "Basic French II". These are likely source materials for questions.
*   `Questions/Object_Oriented_Programming/*.pdf`: PDF documents containing exam papers and quizzes related to "Object Oriented Programming". These are likely source materials for questions.

### `rendered_questions/` Directory

*   `rendered_questions/*.png`: PNG image files of rendered LaTeX questions and explanations, generated by the rendering service.

### `scripts/` Directory

*   `scripts/__init__.py`: An empty `__init__.py` file, marking `scripts` as a Python package.
*   `scripts/clear_course_questions.py`: Script to delete all questions and related user answers for a specific course from the database.
*   `scripts/clear_user_data.py`: Script to clear all user-specific progress data (interaction logs, quiz sessions, user answers) from the database.
*   `scripts/corrected_script.py`: A corrected version of a script, likely related to LaTeX rendering or question preprocessing, addressing previous issues.
*   `scripts/diagnose_s3.py`: Script to diagnose AWS S3 connectivity and permissions by attempting to upload a test file.
*   `scripts/export_questions_to_csv.py`: Script to export all questions for a specific course from the database to a CSV file.
*   `scripts/exported_data/basic_electronics_questions.csv`: CSV file containing exported question data for "Basic Electronics".
*   `scripts/load_french_questions.py`: Script to delete and reload "Basic French II" questions from a JSON file into the database.
*   `scripts/load_new_questions.py`: Script to delete and reload "Basic Electronics" questions from a JSON file into the database.
*   `scripts/preprocess_questions.py`: Offline script for preprocessing LaTeX questions, rendering them to images, and uploading them to S3.
*   `scripts/render_latex.py`: Script for rendering LaTeX questions and explanations to images and uploading them to S3, likely an older or alternative version of the preprocessing script.
*   `scripts/seed_db.py`: Script to populate the database with initial data for faculties, programs, levels, and courses.
*   `scripts/seed_electronics.py`: Script to delete and reload "Basic Electronics" questions from a structured JSON file into the database.
*   `scripts/test_new_renderer.py`: Script to test the `LaTeXRenderingService` by rendering a sample question.
*   `scripts/test_rendering_diagnostics.py`: Comprehensive diagnostic script for the LaTeX rendering service, including S3 caching tests.

### `src/` Directory

*   `src/__init__.py`: An empty `__init__.py` file, marking `src` as a Python package.
*   `src/config.py`: Configuration file for the application, managing environment variables, Telegram bot token, database URL, AWS S3 details, and adaptive quiz settings.
*   `src/database.py`: Module for setting up and managing database connections using SQLAlchemy.
*   `src/logging_config.py`: Module for configuring application-wide logging.
*   `src/main.py`: Main entry point for the Telegram bot application.
*   `src/adaptive_learning/__init__.py`: An empty `__init__.py` file, marking `adaptive_learning` as a Python package.
*   `src/adaptive_learning/selector.py`: Contains the core `UniversalQuestionSelector` algorithm for adaptive question selection, focusing on learning patterns (weakness, SRS, new questions).
*   `src/adaptive_learning/service.py`: Provides the `DatabaseQuestionSelector` and `AdaptiveQuizService` classes, integrating the adaptive algorithm with the database and handling quiz flow.
*   `src/handlers/__init__.py`: An empty `__init__.py` file, marking `handlers` as a Python package.
*   `src/handlers/conversation_handlers.py`: Implements the Telegram bot's conversation flow for quiz initiation, including faculty, program, level, and course selection, and question asking/answering.
*   `src/handlers/general_handlers.py`: Contains general Telegram bot handlers, such as the `/start` command.
*   `src/models/__init__.py`: An empty `__init__.py` file, marking `models` as a Python package.
*   `src/models/models.py`: Defines the SQLAlchemy ORM models for the database schema, including `User`, `Faculty`, `Program`, `Level`, `Course`, `Question`, `UserAnswer`, `QuizSession`, `QuizSessionQuestion`, and `InteractionLog`.
*   `src/services/__init__.py`: An empty `__init__.py` file, marking `services` as a Python package.
*   `src/services/navigation_service.py`: Provides functions for fetching navigation-related data from the database (faculties, programs, levels, courses).
*   `src/services/quiz_service.py`: Manages quiz sessions, including starting new quizzes, getting next questions, submitting answers, and skipping questions, integrating with the adaptive learning service.
*   `src/services/rendering_service.py`: Handles LaTeX question rendering to images and S3 caching, including fallback image generation.
*   `src/services/scoring_service.py`: Provides functions for calculating question time limits based on difficulty scores.